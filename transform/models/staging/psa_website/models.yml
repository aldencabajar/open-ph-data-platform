version: 2

models:
  - name: psa_barangay_census_data
    config:
      materialized: incremental
      unique_key: id
      incremental_strategy: delete+insert
    tests:
      - dbt_utils.expression_is_true:
          expression: "population > 0"
    columns:
      - name: barangay
        data_tests:
          - not_null
      - name: city_municipality
        data_tests:
          - not_null
      - name: region
        data_tests:
          - not_null
      - name: population
        data_tests:
          - not_null
  
  - name: psa_geographical_codes
    config:
      materialized: incremental
      unique_key: geo_code
      incremental_strategy: delete+insert

